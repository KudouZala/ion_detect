import pandas as pd
import matplotlib.pyplot as plt
import os
import plotly.graph_objs as go
import plotly.offline as pyo
import os
import sys

# 动态添加上两级目录到系统路径
base_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), '../../'))
print('base_dir :',base_dir )
ion_color_path = os.path.join(base_dir, 'ion_color.py')

# 如果 ion_color.py 在该路径下，添加该目录到 sys.path
if os.path.exists(ion_color_path):
    sys.path.append(os.path.dirname(ion_color_path))

# 现在你可以导入 ion_color 中的函数了
from ion_color import get_ion_color

# RGB 转换为 matplotlib 颜色格式（归一化为0-1范围）
def rgb_to_mpl_color(rgb_tuple):
    return tuple([x / 255.0 for x in rgb_tuple])

# 将 matplotlib 的 marker 映射到 plotly 支持的 symbol
MATPLOTLIB_TO_PLOTLY_MARKER_MAP = {
    'o': 'circle',
    's': 'square',
    'd': 'diamond',
    'x': 'x',
    '^': 'triangle-up',
    'v': 'triangle-down',
    '<': 'triangle-left',
    '>': 'triangle-right',
    'p': 'pentagon',
    '*': 'star'
}

# vitplot_zhiyun 函数: 处理 Zhiyun 数据并包含颜色、图例和点标记信息，时间在同一个{}内叠加
def vitplot_zhiyun(folder_path, file_names, color, label, marker, folder_cumulative_time):
    total_time = []
    total_voltage = []
    cumulative_time = folder_cumulative_time  # 使用来自主函数的累计时间

    for file_name in file_names:
        file_path = os.path.join(folder_path, file_name)
        if not os.path.isfile(file_path):
            print(f"文件未找到: {file_path}. 跳过...")
            continue
        df = pd.read_csv(file_path)

        # 确保列名无误
        time_col = 'StepTime/s'
        voltage_col = 'Voltage/V'

        if time_col not in df.columns or voltage_col not in df.columns:
            print(f"在 {file_path} 中未找到所需的列。跳过此文件。")
            continue

        time = df[time_col].to_list()
        voltage = df[voltage_col].to_list()

        # 将时间在该 folder 内累加
        adjusted_time = [t + cumulative_time for t in time]
        cumulative_time = adjusted_time[-1] if adjusted_time else cumulative_time

        total_time.extend(adjusted_time)
        total_voltage.extend(voltage)

    # 返回数据，词典内的累计时间已经完成
    return {
        'Time': total_time,
        'Voltage': total_voltage,
        'color': rgb_to_mpl_color(color),  # 转换颜色为 matplotlib 格式
        'legend': label,
        'marker': marker,
        'last_time': cumulative_time  # 返回最新的累计时间
    }

# gamry 数据提取函数
def convert_dta_to_excel(folder_path, file_patterns, folder_cumulative_time):
    combined_data = {'Time': [], 'Voltage': []}
    cumulative_time = folder_cumulative_time  # 使用传递进来的累计时间

    for pattern_info in file_patterns:
        pattern = pattern_info['pattern']
        file_range = pattern_info['range']

        for i in file_range:
            file_name = f"{pattern}{i}.DTA"
            file_path = os.path.join(folder_path, file_name)
            if os.path.isfile(file_path):
                print(f"正在处理文件: {file_path}")
                with open(file_path, 'r') as file:
                    lines = file.readlines()

                indices = find_data_starting_indices(lines)
                if None in indices.values():
                    print(f"在 {file_path} 中未找到所需的列。跳过此文件。")
                    continue

                try:
                    data = extract_data_from_lines(lines, indices)
                    df = pd.DataFrame(data)
                    df['Time'] = df['Time'] + cumulative_time
                    if not df.empty:
                        cumulative_time = df['Time'].iloc[-1]  # 当前文件的时间累加
                        combined_data['Time'].extend(df['Time'])
                        combined_data['Voltage'].extend(df['Voltage'])
                except Exception as e:
                    print(f"处理文件 {file_path} 时出错: {e}")
                    continue

    return combined_data, cumulative_time  # 返回时间累加后的数据和最后的累计时间

def find_data_starting_indices(lines):
    indices = {'T': None, 'Vf': None, 'Im': None}
    for i, line in enumerate(lines):
        columns = line.strip().split('\t')
        for j, column in enumerate(columns):
            if column in indices:
                indices[column] = (i, j)
    return indices

def extract_data_from_lines(lines, indices):
    data = {'Time': [], 'Voltage': [], 'Current': []}
    start_row = max(indices['T'][0], indices['Vf'][0], indices['Im'][0]) + 2
    for line in lines[start_row:]:
        columns = line.strip().split('\t')
        if len(columns) > max(indices['T'][1], indices['Vf'][1], indices['Im'][1]):
            try:
                data['Time'].append(float(columns[indices['T'][1]]))
                data['Voltage'].append(float(columns[indices['Vf'][1]]))
                data['Current'].append(float(columns[indices['Im'][1]]))
            except ValueError:
                print(f"Non-numeric data encountered. Skipping line: {line.strip()}")
                continue
    return data

# 绘制数据（Matplotlib）
def plot_combined_data(data_list, output_folder, marker_size=5, line_width=1,output_name='combined_vt_plot.png'):
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    plt.figure(figsize=(10, 6))
    print(f"Starting to plot {len(data_list)} datasets.")

    for data in data_list:
        if len(data['Time']) == 0:
            print(f"No data to plot for {data['legend']}. Skipping...")
            continue
        print(f"Plotting {data['legend']} with {len(data['Time'])} time points.")
        plt.plot(
            data['Time'],
            data['Voltage'],
            label=data['legend'],
            color=data['color'],
            marker=data['marker'],
            markersize=marker_size,   # 自定义点大小
            linewidth=line_width      # 自定义线宽
        )

    plt.xlabel('Time (s)')
    plt.ylabel('Voltage (V)')
    plt.title('Voltage vs Time')

    # 调整图例位置和字体大小
    plt.legend(loc='upper center', bbox_to_anchor=(0.5, -0.1), ncol=3, fontsize='small')

    plt.grid(True)

    output_path = os.path.join(output_folder, output_name)
    print(f"Saving plot to {output_path}")
    plt.savefig(output_path, bbox_inches='tight')  # 使用 bbox_inches 保证图例不会被裁剪
    plt.close()

    print(f"Combined plot saved to: {output_path}")

def plot_combined_data_plotly(data_list, output_html_path):
    fig = go.Figure()
    print(f"Starting to plot {len(data_list)} datasets in Plotly.")

    for data in data_list:
        if len(data['Time']) == 0:
            print(f"No data to plot for {data['legend']} in interactive plot. Skipping...")
            continue
        print(f"Plotting {data['legend']} with {len(data['Time'])} time points.")
        plotly_marker_symbol = MATPLOTLIB_TO_PLOTLY_MARKER_MAP.get(data['marker'], 'circle')  # 默认使用 'circle'

        fig.add_trace(go.Scatter(
            x=data['Time'],
            y=data['Voltage'],
            mode='lines+markers',
            name=data['legend'],
            line=dict(color=f'rgb{tuple(int(c*255) for c in data["color"])}'),  # Convert back to 0-255 range for Plotly
            marker=dict(symbol=plotly_marker_symbol)
        ))

    fig.update_layout(
        title='Voltage vs Time (Interactive)',
        xaxis_title='Time (s)',
        yaxis_title='Voltage (V)',
        showlegend=True
    )

    print(f"Saving interactive plot to {output_html_path}")
    pyo.plot(fig, filename=output_html_path)
    print(f"Interactive plot saved to: {output_html_path}")

# 主函数

def main():
    zhiyun_data_list = [
        # {
        #     'folder': [
        #         r"20240915_2ppm铜离子污染测试\旧版电解槽_firecloud\20240914_ion_column",
        #         r"20240915_2ppm铜离子污染测试\旧版电解槽_firecloud\20240914_ion",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／24)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(2／24)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(3／24)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(4／24)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(5／24)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #     ],
        #     'color': [
        #     ],
        #     'legend': [
        #         '2ppm Cu2+_ion_column_0915_firecloud',
        #         '2ppm Cu2+_0915_firecloud',
        #     ],
        #     'marker': [
        #         'o',
        #         'x', # 对应 Cu2+
        #     ]
        # },
        
        
        # {
        #     'folder': [
        #         r"20241001_2ppm铁离子污染测试\旧版电解槽_firecloud\20240930_ion_column",
        #         r"20241001_2ppm铁离子污染测试\旧版电解槽_firecloud\20240931_ion",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组1(工步组)(14／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #     ],
        #     'color': [
        #     ],
        #     'legend': [
        #         '2ppm Fe3+_ion_column_1001_firecloud',
        #         '2ppm Fe3+_1001_firecloud',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Fe3+
        #         'x',
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241003_2ppm镍离子污染测试\旧版电解槽_firecloud\20241002_ion_column",
        #         r"20241003_2ppm镍离子污染测试\旧版电解槽_firecloud\20241003_ion",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(27／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(28／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(29／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(30／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #     ],
        #     'color': [
        #     ],
        #     'legend': [
        #         '2ppm Ni2+_ion_column_1003_firecloud',
        #         '2ppm Ni2+_1003_firecloud',
        #     ],
        #     'marker': [
        #         'o',
        #         'x',  # 对应 Ni2+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241006_2ppm铬离子污染测试\旧版电解槽_firecloud\20241005_ion_column",
        #         r"20241006_2ppm铬离子污染测试\旧版电解槽_firecloud\20241006_ion",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(27／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #     ],
        #     'color': [
        #     ],
        #     'legend': [
        #         '2ppm Cr3+_ion_column_1006_firecloud',
        #         '2ppm Cr3+_1006_firecloud',
        #     ],
        #     'marker': [
        #         'o',
        #         'x',  # 对应 Cr3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241008_无离子污染测试\新版电解槽_firecloud\20241008_ion_column",
        #     ],
        #     'files': [
        #          [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #     ],
        #     'color': [
        #     ],
        #     'legend': [
        #         '2ppm no_ion_ion_column_1008_firecloud',
        #     ],
        #     'marker': [
        #         'o',
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241010_2ppm钠离子污染测试\新版电解槽_firecloud\20241010_ion_column",
        #         r"20241010_2ppm钠离子污染测试\新版电解槽_firecloud\20241011_ion",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(27／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(28／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #     ],
        #     'color': [
        #     ],
        #     'legend': [
        #         '2ppm Na+_ion_column_1011_firecloud',
        #         '2ppm Na+_1011_firecloud',
        #     ],
        #     'marker': [
        #         'o',
        #         'x',  # 对应 Na+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241013_2ppm铝离子污染测试\新版电解槽_firecloud\20241014_ion_column",
        #         r"20241013_2ppm铝离子污染测试\新版电解槽_firecloud\20241015_ion",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #             # 你可以继续添加其他文件名
        #         ],
        #     ],
        #     'color': [],
        #     'legend': [
        #         '2ppm Al2+_ion_column_1013_firecloud',
        #         '2ppm Al2+_1013_firecloud',
        #     ],
        #     'marker': [
        #         'o',
        #         'd',  # 对应 Al2+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241020_2ppm镍离子污染和恢复测试\新版电解槽_firecloud\20241018_ion_column",
        #         r"20241020_2ppm镍离子污染和恢复测试\新版电解槽_firecloud\20241020_ion",
        #         r"20241020_2ppm镍离子污染和恢复测试\新版电解槽_firecloud\20241022_ion_column_renew",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(27／80)_工步1(CC).csv",
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #         ],
        #     ],
        #     'color': [],
        #     'legend': [
        #         '2ppm Ni2+_ion_column_1020_firecloud',
        #         '2ppm Ni2+_1020_firecloud',
        #         '2ppm Ni2+_1020_renew_firecloud',

        #     ],
        #     'marker': [
        #         'o',
        #         'd',  # 对应 Al2+
        #         'x',
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241024_2ppm铁离子污染和恢复测试\新版电解槽_firecloud\20241024_ion_column",
        #         r"20241024_2ppm铁离子污染和恢复测试\新版电解槽_firecloud\20241025_ion",
        #         r"20241024_2ppm铁离子污染和恢复测试\新版电解槽_firecloud\20241027_ion_column_renew",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #         ],
        #     ],
        #     'color': [],
        #     'legend': [
        #         '2ppm Fe3+_ion_column_1024_firecloud',
        #         '2ppm Fe3+_1024_firecloud',
        #         '2ppm Fe3+_1024_renew_firecloud',

        #     ],
        #     'marker': [
        #         'o',
        #         'd',  # 对应 Al2+
        #         'x',
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241029_2ppm铁离子污染和恢复测试\新版电解槽_firecloud\20241027_ion_column",
        #         r"20241029_2ppm铁离子污染和恢复测试\新版电解槽_firecloud\20241029_ion",
        #         r"20241029_2ppm铁离子污染和恢复测试\新版电解槽_firecloud\20241031_ion_column_renew",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(27／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(28／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",

        #         ],
        #     ],
        #     'color': [],
        #     'legend': [
        #         '2ppm Fe3+_ion_column_1029_firecloud',
        #         '2ppm Fe3+_1029_firecloud',
        #         '2ppm Fe3+_1029_renew_firecloud',

        #     ],
        #     'marker': [
        #         'o',
        #         'd',  # 对应 Al2+
        #         'x',
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241101_2ppm钙离子污染和恢复测试\新版电解槽_firecloud\20241031_ion_column",
        #         r"20241101_2ppm钙离子污染和恢复测试\新版电解槽_firecloud\20241101_ion",
        #         r"20241101_2ppm钙离子污染和恢复测试\新版电解槽_firecloud\20241103_ion_column_renew",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",

        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(27／80)_工步1(CC).csv",
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #         ],
        #     ],
        #     'color': [],
        #     'legend': [
        #         '2ppm Ca2+_ion_column_1101_firecloud',
        #         '2ppm Ca2+_1101_firecloud',
        #         '2ppm Ca2+_1101_renew_firecloud',

        #     ],
        #     'marker': [
        #         'o',
        #         'd',  # 对应 Al2+
        #         'x',
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241107_0.1ppm钙离子污染及恢复测试\新版电解槽_firecloud\20241105_ion_column",
        #         r"20241107_0.1ppm钙离子污染及恢复测试\新版电解槽_firecloud\20241107_ion",
        #         r"20241107_0.1ppm钙离子污染及恢复测试\新版电解槽_firecloud\20241109_ion_column_renew",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",


        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(27／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(28／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(29／80)_工步1(CC).csv",
                   
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #         ],
        #     ],
        #     'color': [],
        #     'legend': [
        #         '0.1ppm Ca2+_ion_column_1107_firecloud',
        #         '0.1ppm Ca2+_1107_firecloud',
        #         '0.1ppm Ca2+_1107_renew_firecloud',

        #     ],
        #     'marker': [
        #         'o',
        #         'd',  # 对应 Al2+
        #         'x',
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241201_2ppm铜离子污染及恢复测试\新版电解槽_firecloud\20241201_ion_column",
        #         r"20241201_2ppm铜离子污染及恢复测试\新版电解槽_firecloud\20241202_ion",
        #         r"20241201_2ppm铜离子污染及恢复测试\新版电解槽_firecloud\20241204_ion_column_renew",
        #     ],
        #     'files': [
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",


        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #              "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(14／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(15／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(16／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(17／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(18／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(19／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(20／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(21／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(22／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(23／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(24／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(25／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(26／80)_工步1(CC).csv",
   
                   
        #             # 你可以继续添加其他文件名
        #         ],
        #         [
        #             "循环1／1_工步组1(工步组)(1／1)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(1／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(2／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(3／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(4／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(5／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(6／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(7／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(8／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(9／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(10／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(11／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(12／80)_工步1(CC).csv",
        #             "循环1／1_工步组2(工步组)(13／80)_工步1(CC).csv",
        #         ],
        #     ],
        #     'color': [],
        #     'legend': [
        #         '2ppm Cu2+_ion_column_1201_firecloud',
        #         '2ppm Cu2+_1201_firecloud',
        #         '2ppm Cu2+_1201_renew_firecloud',

        #     ],
        #     'marker': [
        #         'o',
        #         'd',  # 对应 Al2+
        #         'x',
        #     ]
        # },

    ]

    gamry_data_list = [
        # {
        #     'folder': [
        #         r"20240813-0814_10ppm铜离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240813-0814_10ppm铜离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240813-0814_10ppm铜离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240813-0814_10ppm铜离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240812_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240813_no_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240814_ion_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240814_ion_renew_", "range": list(range(0, 50))},
        #     ],
        #     'color': [],
        #     'legend': [
        #         '10ppm Cu2+_0813_ion_column_gamry',
        #         '10ppm Cu2+_0813_no_ion_column_gamry',
        #         '10ppm Cu2+_0813_ion_gamry',
        #         '10ppm Cu2+_0813_ion_H2SO4_renew_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Ni2+
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #         'd',  # 对应 Ca2+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240815-0817_10ppm铁离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240815-0817_10ppm铁离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240815-0817_10ppm铁离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240815-0817_10ppm铁离子污染和恢复测试（拔去离子柱跑误差较大）\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240815_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240815_no_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240815_ion_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240816_ion_renew_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (204, 153, 102),  # 2ppm Ni2+_1003_gamry
        #         (204, 153, 102),  # 2ppm Cu2+_0915_gamry
        #         (204, 153, 102),
        #         (204, 153, 102),
        #     ],
        #     'legend': [
        #         '10ppm Fe3+_0815_ion_column_gamry',
        #         '10ppm Fe3+_0815_no_ion_column_gamry',
        #         '10ppm Fe3+_0815_ion_gamry',
        #         '10ppm Fe3+_0815_ion_H2SO4_renew_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Ni2+
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #         'd',  # 对应 Ca2+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240820_100ppm铜离子污染和恢复测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240820_100ppm铜离子污染和恢复测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240820_100ppm铜离子污染和恢复测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240819_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240820_no_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240820_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (0, 128, 255),  # 2ppm Ni2+_1003_gamry
        #         (0, 128, 255),  # 2ppm Cu2+_0915_gamry
        #         (0, 128, 255),
        #     ],
        #     'legend': [
        #         '100ppm Cu2+_0820_ion_column_gamry',
        #         '100ppm Cu2+_0820_no_ion_column_gamry',
        #         '100ppm Cu2+_0820_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Ni2+
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240822_10ppm铜离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240822_10ppm铜离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240821_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240822_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (102, 204, 255),  # 2ppm Ni2+_1003_gamry
        #         (102, 204, 255),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '10ppm Cu2+_0822_ion_column_gamry',
        #         '10ppm Cu2+_0822_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240823_10ppm钙离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240823_10ppm钙离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240823_10ppm钙离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240823_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240824_ion_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240826_ion_renew_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (204, 153, 255),  # 2ppm Ni2+_1003_gamry
        #         (204, 153, 255),  # 2ppm Cu2+_0915_gamry
        #         (204, 153, 255),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '10ppm Ca2+_0823_ion_column_gamry',
        #         '10ppm Ca2+_0823_ion_gamry',
        #         '10ppm Ca2+_0823_ion_H2SO4_renew_gamry',

        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #         'd',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240827_10ppm铬离子污染和恢复测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240827_10ppm铬离子污染和恢复测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240827_10ppm铬离子污染和恢复测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240827_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240828_ion_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240829_ion_renew_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (102, 204, 102),  # 2ppm Ni2+_1003_gamry
        #         (102, 204, 102),  # 2ppm Cu2+_0915_gamry
        #         (102, 204, 102),
        #     ],
        #     'legend': [
        #         '10ppm Cr3+_0827_ion_column_gamry',
        #         '10ppm Cr3+_0827_ion_gamry',
        #         '10ppm Cr3+_0827_ion_H2SO4_renew_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Ni2+
        #         'x',  # 对应 Fe3+
        #         'd',  # 对应 Ca2+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240831_10ppm镍离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240831_10ppm镍离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240830_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240831_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (102, 204, 153),  # 2ppm Ni2+_1003_gamry
        #         (102, 204, 153),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '10ppm Ni2+_0830_ion_column_gamry',
        #         '10ppm Ni2+_0830_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Ni2+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240907_10ppm铁离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240907_10ppm铁离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240904_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240905_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (204, 153, 102),  # 2ppm Ni2+_1003_gamry
        #         (204, 153, 102),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '10ppm Fe3+_0815_ion_column_gamry',
        #         '10ppm Fe3+_0815_ion_gamry',

        #     ],
        #     'marker': [
        #         'o',  # 对应 Ni2+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240910_10ppm钙离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240910_10ppm钙离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240907_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240908_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (204, 153, 255),  # 2ppm Ni2+_1003_gamry
        #         (204, 153, 255),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '10ppm Ca2+_0907_ion_column_gamry',
        #         '10ppm Ca2+_0907_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240915_2ppm铜离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240915_2ppm铜离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240914_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240914_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (204, 255, 255),  # 2ppm Ni2+_1003_gamry
        #         (204, 255, 255),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '2ppm Cu2+_0915_ion_column_gamry',
        #         '2ppm Cu2+_0915_ion_gamry',
        #
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20240918_2ppm钙离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20240918_2ppm钙离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240917_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20240917_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (230, 200, 255),  # 2ppm Ni2+_1003_gamry
        #         (230, 200, 255),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '2ppm Ca2+_0917_ion_column_gamry',
        #         '2ppm Ca2+_0917_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241001_2ppm铁离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20241001_2ppm铁离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20240930_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20241001_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (255, 230, 204),  # 2ppm Ni2+_1003_gamry
        #         (255, 230, 204),  # 2ppm Cu2+_0915_gamry
        #     ],
        #     'legend': [
        #         '2ppm Fe3+_1001_ion_column_gamry',
        #         '2ppm Fe3+_1001_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241003_2ppm镍离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20241003_2ppm镍离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20241002_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20241003_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (173, 255, 204),  # 2ppm Ni2+_1003_gamry
        #         (173, 255, 204),  # 2ppm Ni2+_1003_gamry
        #     ],
        #     'legend': [
        #         '2ppm Ni2+_1003_ion_column_gamry',
        #         '2ppm Ni2+_1003_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241006_2ppm铬离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20241006_2ppm铬离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20241005_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20241006_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #         (200, 255, 200),  # 2ppm Ni2+_1003_gamry
        #         (200, 255, 200),  # 2ppm Ni2+_1003_gamry
        #     ],
        #     'legend': [
        #         '2ppm Cr3+_1006_ion_column_gamry',
        #         '2ppm Cr3+_1006_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        # {
        #     'folder': [
        #         r"20241017_2ppm铬离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #         r"20241017_2ppm铬离子污染测试\新版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
        #     ],
        #     'patterns': [
        #         {"pattern": "cm2_20241017_ion_column_", "range": list(range(0, 50))},
        #         {"pattern": "cm2_20241018_ion_", "range": list(range(0, 50))},
        #     ],
        #     'color': [
        #     ],
        #     'legend': [
        #         '2ppm Cr3+_1020_ion_column_gamry',
        #         '2ppm Cr3+_1020_ion_gamry',
        #     ],
        #     'marker': [
        #         'o',  # 对应 Cr3+
        #         'x',  # 对应 Fe3+
        #     ]
        # },
        {
            'folder': [
                r"20241028_2ppm钠离子污染和恢复测试\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
                r"20241028_2ppm钠离子污染和恢复测试\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
                r"20241028_2ppm钠离子污染和恢复测试\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
            ],
            'patterns': [
                {"pattern": "cm2_20241027_ion_column_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241029_ion_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241031_ion_column_", "range": list(range(0, 50))},
            ],
            'color': [
            ],
            'legend': [
                '2ppm Na+_1028_ion_column_gamry',
                '2ppm Na+_1028_ion_gamry',
                '2ppm Na+_1028_ion_column_renewgamry',
            ],
            'marker': [
                'o',  # 对应 Cr3+
                'x',  # 对应 Fe3+
                '+',  # 对应 Fe3+
            ]
        },
        {
            'folder': [
                r"20241112_2ppm钠离子污染和恢复测试80摄氏度\新版电解槽_gamry\PWRGALVANOSTATIC_80℃_150ml_1A",
                r"20241112_2ppm钠离子污染和恢复测试80摄氏度\新版电解槽_gamry\PWRGALVANOSTATIC_80℃_150ml_1A",
                r"20241112_2ppm钠离子污染和恢复测试80摄氏度\新版电解槽_gamry\PWRGALVANOSTATIC_80℃_150ml_1A",
            ],
            'patterns': [
                {"pattern": "cm2_20241112_ion_column_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241113_ion_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241115_ion_column_", "range": list(range(0, 50))},
            ],
            'color': [
            ],
            'legend': [
                '2ppm Na+_1112_ion_column_gamry',
                '2ppm Na+_1112_ion_gamry',
                '2ppm Na+_1112_ion_column_renew_gamry',
            ],
            'marker': [
                'o',  # 对应 Cr3+
                'x',  # 对应 Fe3+
                '+',  # 对应 Fe3+
            ]
        },
        {
            'folder': [
                r"20241112_2ppm镍离子污染及恢复测试\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
                r"20241112_2ppm镍离子污染及恢复测试\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
                r"20241112_2ppm镍离子污染及恢复测试\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_150ml_1A",
            ],
            'patterns': [
                {"pattern": "cm2_20241112_ion_column_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241113_ion_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241115_ion_column_", "range": list(range(0, 50))},
            ],
            'color': [
            ],
            'legend': [
                '2ppm Ni2+_1112_ion_column_gamry',
                '2ppm Ni2+_1112_ion_gamry',
                '2ppm Ni2+_1112_ion_column_renew_gamry',
            ],
            'marker': [
                'o',  # 对应 Cr3+
                'x',  # 对应 Fe3+
                '+',  # 对应 Fe3+
            ]
        },
        {
            'folder': [
                r"20241117_2ppm钠离子污染及恢复测试10mlmin\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_10ml_1A",
                r"20241117_2ppm钠离子污染及恢复测试10mlmin\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_10ml_1A",
                r"20241117_2ppm钠离子污染及恢复测试10mlmin\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_10ml_1A",
            ],
            'patterns': [
                {"pattern": "cm2_20241118_ion_column_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241119_ion_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241121_ion_column_renew_", "range": list(range(0, 50))},
            ],
            'color': [
            ],
            'legend': [
                '2ppm Na+_1117_ion_column_gamry',
                '2ppm Na+_1117_ion_gamry',
                '2ppm Na+_1117_ion_column_renew_gamry',
            ],
            'marker': [
                'o',  # 对应 Cr3+
                'x',  # 对应 Fe3+
                '+',  # 对应 Fe3+
            ]
        },
        {
            'folder': [
                r"20241122_2ppm钠离子污染及恢复测试300mlmin\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_300ml_1A",
                r"20241122_2ppm钠离子污染及恢复测试300mlmin\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_300ml_1A",
                r"20241122_2ppm钠离子污染及恢复测试300mlmin\旧版电解槽_gamry\PWRGALVANOSTATIC_60℃_300ml_1A",
            ],
            'patterns': [
                {"pattern": "cm2_20241122_ion_column_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241123_ion_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241125_ion_column_renew_", "range": list(range(0, 50))},
            ],
            'color': [
            ],
            'legend': [
                '2ppm Na+_1122_ion_column_gamry',
                '2ppm Na+_1122_ion_gamry',
                '2ppm Na+_1122_ion_column_renew_gamry',
            ],
            'marker': [
                'o',  # 对应 Cr3+
                'x',  # 对应 Fe3+
                '+',  # 对应 Fe3+
            ]
        },
        {
            'folder': [
                r"20241122_2ppm铜离子污染及恢复测试40摄氏度\新版电解槽_gamry\PWRGALVANOSTATIC_40℃_150ml_1A",
                r"20241122_2ppm铜离子污染及恢复测试40摄氏度\新版电解槽_gamry\PWRGALVANOSTATIC_40℃_150ml_1A",
                r"20241122_2ppm铜离子污染及恢复测试40摄氏度\新版电解槽_gamry\PWRGALVANOSTATIC_40℃_150ml_1A",
            ],
            'patterns': [
                {"pattern": "cm2_20241122_ion_column_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241123_ion_", "range": list(range(0, 50))},
                {"pattern": "cm2_20241125_ion_column_renew_", "range": list(range(0, 50))},
            ],
            'color': [
            ],
            'legend': [
                '2ppm Cu2+_1122_ion_column_gamry',
                '2ppm Cu2+_1122_ion_gamry',
                '2ppm Cu2+_1122_ion_column_renew_gamry',
            ],
            'marker': [
                'o',  # 对应 Cr3+
                'x',  # 对应 Fe3+
                '+',  # 对应 Fe3+
            ]
        },

    ]
        # 更新颜色字段
    for color_data in gamry_data_list:
        color_data['color'] = [get_ion_color(folder) for folder in color_data['folder']]

            # 更新颜色字段
    for color_data in zhiyun_data_list:
        color_data['color'] = [get_ion_color(folder) for folder in color_data['folder']]

    import os
    # 获取当前文件的路径
    current_dir = os.path.dirname(os.path.abspath(__file__))

    # 获取上三级目录并将其中的 '/' 替换为 '\\'
    parent_dir_filename = os.path.abspath(os.path.join(current_dir, os.pardir, os.pardir, os.pardir)).replace('/', '\\')


    # 遍历 gamry_data_list，修改 'folder' 中的路径
    # 判断操作系统
    for filename_data in gamry_data_list:
         if os.name == 'posix':  # Linux/Unix 系统
            filename_data['folder'] = [
                os.path.join(parent_dir_filename, "校内测试",folder_path.lstrip(os.sep)).replace('\\', '/')# 在这里拼接路径时，不修改 folder_path
                for folder_path in filename_data['folder']
            ]
         elif os.name == 'nt':  # Windows 系统
            filename_data['folder'] = [
                os.path.join(parent_dir_filename, "校内测试",folder_path.lstrip(os.sep)).replace('/', '\\')# 在这里拼接路径时，不修改 folder_path
                for folder_path in filename_data['folder']
            ]
        
    # 遍历 gamry_data_list，修改 'folder' 中的路径
    for filename_data in zhiyun_data_list:
         if os.name == 'posix':  # Linux/Unix 系统
            filename_data['folder'] = [
                os.path.join(parent_dir_filename, "校内测试",folder_path.lstrip(os.sep)).replace('\\', '/')# 在这里拼接路径时，不修改 folder_path
                for folder_path in filename_data['folder']
            ]
         elif os.name == 'nt':  # Windows 系统
            filename_data['folder'] = [
                os.path.join(parent_dir_filename, "校内测试",folder_path.lstrip(os.sep)).replace('/', '\\')# 在这里拼接路径时，不修改 folder_path
                for folder_path in filename_data['folder']
            ]

    print("gamry_data_list:",gamry_data_list)
    print("zhiyun_data_list:",zhiyun_data_list)


    combined_data = []

    # 处理 Zhiyun 数据
    for zhiyun_info in zhiyun_data_list:
        folders = zhiyun_info['folder']
        files_list = zhiyun_info['files']
        colors = zhiyun_info['color']
        legends = zhiyun_info['legend']
        markers = zhiyun_info['marker']

        folder_cumulative_time = 0  # 重置累计时间

        for i in range(len(folders)):
            folder = folders[i]
            files = files_list[i]
            color = colors[i]
            legend = legends[i]
            marker = markers[i]

            zhiyun_data = vitplot_zhiyun(folder, files, color, legend, marker, folder_cumulative_time)
            folder_cumulative_time = zhiyun_data['last_time']  # 更新累计时间
            combined_data.append(zhiyun_data)

    # 处理 Gamry 数据
    for gamry_info in gamry_data_list:
        folders = gamry_info['folder']
        patterns_list = gamry_info['patterns']
        colors = gamry_info['color']
        legends = gamry_info['legend']
        markers = gamry_info['marker']

        folder_cumulative_time = 0  # 重置累计时间

        for i in range(len(folders)):
            folder = folders[i]
            patterns = patterns_list[i]
            color = colors[i]
            legend = legends[i]
            marker = markers[i]

            gamry_data, folder_cumulative_time = convert_dta_to_excel(folder, [patterns], folder_cumulative_time)
            if len(gamry_data['Time']) > 0:
                combined_data.append({
                    'Time': gamry_data['Time'],
                    'Voltage': gamry_data['Voltage'],
                    'color': rgb_to_mpl_color(color),
                    'legend': legend,
                    'marker': marker
                })

    # 绘制数据（Matplotlib）
    import os

    # 获取当前 Python 脚本所在的目录
    current_dir = os.path.dirname(os.path.abspath(__file__))

    # 向上跳三级目录
    output_folder = os.path.abspath(os.path.join(current_dir, "../../../图片输出文件夹"))

    plot_combined_data(combined_data, output_folder, marker_size=1, line_width=0.1,output_name="test.png")

    # 绘制交互式图表（Plotly）
    output_html_path = os.path.join(output_folder, 'combined_vt_plot_interactive.html')
    plot_combined_data_plotly(combined_data, output_html_path)

if __name__ == "__main__":
    main()


